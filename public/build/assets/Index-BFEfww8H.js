import{j as e,Y as G,q as T,r as u,t as ie,m as Q,a as le,b as ce,h as de}from"./app-DdujxetC.js";import{H as me}from"./HomeLayout-DOTPFD1x.js";import{L as Y}from"./Logo-Dq8nsJV3.js";import{g as F}from"./imageHelper-19DfnHcd.js";import{u as U}from"./useTranslation-8BayAZb4.js";import{r as fe}from"./HomeCarousel-DaNJ6o_C.js";import{C as ee}from"./CardProduct-BuaMj2uS.js";import{F as ue}from"./CubeIcon-C1UE8dH0.js";import{I as ge}from"./index.es-BVb1l-Mq.js";import{C as J}from"./CardProductSkeleton-DR23j_dc.js";import"./ApplicationLogo-DDW-aaz4.js";import"./LoginGoogleButton-DzpqdfCm.js";import"./TextInput-BmMh6PqU.js";import"./Checkbox-BbuAp7Rg.js";import"./index-Rb7ez85R.js";import"./index-BnYHGNjJ.js";import"./floating-ui.dom-AzuEyJcm.js";import"./XMarkIcon-Duw6_-fQ.js";import"./transition-BZAsKsJL.js";import"./dialog-Cmhm8y39.js";import"./LanguageDropdown-CZVTQBmi.js";import"./ResponsiveNavLink-DDPMZpeH.js";import"./Avatar-D3FqKlbf.js";import"./ChatBubbleLeftRightIcon-BSQqBWTT.js";import"./Rating-XxgJT9dk.js";import"./index-CZ0tZ6fy.js";import"./HeartIcon-BIzo_fDE.js";function he({categories:i=[],isLoading:r=!1}){const{t:d,i18n:s}=U(),l=8,t=i.length,m=Math.max(0,l-t);return e.jsx("section",{children:e.jsx("div",{className:`grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-3 text-xs font-semibold text-center text-gray-700 ${r?"animate-pulse":""}`,children:r?Array.from({length:l}).map((g,f)=>e.jsxs("div",{className:"bg-white rounded-lg p-2 shadow flex flex-col items-center space-y-1",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 w-12 bg-gray-200 rounded"})]},f)):e.jsxs(e.Fragment,{children:[m>0&&e.jsxs("div",{className:"p-2 bg-gradient-to-tr from-emerald-500 to-green-500 rounded-t-2xl border-b-8 border-[#D9B36A] shadow flex flex-col items-center space-y-1 col-span-3",children:[e.jsx("h2",{className:"text-white text-2xl font-bold",children:d("home.categories")}),e.jsx("p",{className:"text-md text-white",children:d("home.exploreCategories")})]}),i.map(g=>{const f=s.language==="en"?g.name_en:g.name_id;return e.jsxs(G,{href:route("home.search",{category:g.name_id}),className:"bg-white rounded-lg p-2 shadow flex flex-col items-center space-y-1 cursor-pointer hover:shadow-md transition",children:[e.jsx("img",{src:g.image?F(g.image):Y,alt:f,className:"w-10 h-10 object-contain mb-2",onError:h=>{h.target.onerror=null,h.target.src=Y}}),e.jsx("span",{className:"text-gray-600",children:f})]},g.id)})]})})})}function X({type:i="event_top"}){const r=T().props.banners||[],d=u.useMemo(()=>r.filter(t=>t.type==="event"),[r]);let s=[];d.length>=4&&(i==="event_top"?s=[d.find(t=>t.title==="event1"),d.find(t=>t.title==="event2")]:s=[d.find(t=>t.title==="event3"),d.find(t=>t.title==="event4")],s=s.filter(Boolean));const l=s.length===2?s.map(t=>({image:F(t.image,t.title),alt:t.header||t.title,href:t.link||"#"})):[{image:"https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=cover&w=600&q=80",alt:"Ramadan Promo",href:"#"},{image:"https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=cover&w=600&q=80",alt:"Free Shipping",href:"#"}];return e.jsx("section",{className:"grid grid-cols-2 gap-4 sm:grid-cols-2",children:l.map((t,m)=>e.jsx(G,{href:t.href||"#",target:t.href&&t.href!=="#"?"_blank":void 0,rel:t.href&&t.href!=="#"?"noopener noreferrer":void 0,className:"rounded-xl overflow-hidden w-full h-20 sm:h-40 block",style:{backgroundImage:`url(${t.image})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},title:t.alt||"Promo Banner"},m))})}function pe(){return e.jsxs("div",{className:"flex gap-5 w-full",children:[e.jsx("div",{className:"w-56",children:e.jsx("div",{className:"w-full h-full rounded-md flex items-center justify-center animate-pulse bg-gray-200"})}),e.jsx("div",{className:"flex gap-4 flex-1",children:Array.from({length:4}).map((i,r)=>e.jsxs("div",{className:"w-56 h-72 rounded-xl shadow flex flex-col animate-pulse bg-gray-200",children:[e.jsx("div",{className:"h-40 rounded-t-xl w-full bg-gray-300"}),e.jsxs("div",{className:"p-4 flex flex-col flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-1/2"}),e.jsxs("div",{className:"mt-auto flex space-x-1",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-4"})]})]})]},r))})]})}function te(){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-6 flex items-center justify-center mb-4",children:e.jsx(ue,{className:"w-12 h-12 text-gray-400"})}),e.jsx("div",{className:"text-gray-500 text-lg font-medium",children:ie("product.notFound")})]})}function K({products:i=[],title:r,imageUrl:d,isLoading:s,isRecommendationType:l=!0}){const[t,m]=fe.useKeenSlider({mode:"free-snap",slides:{perView:4.5,spacing:15},breakpoints:{"(max-width: 1200px)":{slides:{perView:3.5,spacing:15}},"(max-width: 900px)":{slides:{perView:2.5,spacing:15}},"(max-width: 600px)":{slides:{perView:1.8,spacing:15}}}}),f=(T().props.banners||[]).filter(c=>c.type==="slider"),h=l?"recommendation":"our_choice",y=f.find(c=>c.title===`${h}`),j=(y==null?void 0:y.image)||`banner_${h}`,o=c=>{Q.get(`/product/${c}`)};return e.jsxs("section",{className:"w-full",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-gray-900 font-semibold text-lg",children:r})}),s?e.jsx(pe,{}):i.length===0?e.jsx(te,{}):e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"md:w-56 w-20 hidden sm:block mr-4",children:e.jsx(xe,{imageUrl:j})}),e.jsx("div",{className:"w-full overflow-hidden",ref:t,children:e.jsx("div",{className:"keen-slider cursor-grab",children:i.map(c=>e.jsx("div",{className:"keen-slider__slide py-2",onClick:()=>o(c.id),children:e.jsx(ee,{product:c,isFavorited:c.isFavorite,favoriteDisplayOnly:!0,showFavorite:!0},c.id)},c.id))})})]})]})}const xe=({imageUrl:i=null})=>{const[r,d]=u.useState(!1),s=i&&!r?F(i):null,l=e.jsx("div",{className:"w-full h-full bg-[#0E1C2D] flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-center px-2",children:"Pundensari Food"})});return e.jsx("div",{className:"w-56 h-80 lg:flex border rounded-lg overflow-hidden items-center justify-center",children:s?e.jsx("img",{src:s,alt:"Promo Banner",className:"w-full h-full object-cover",onError:()=>d(!0)}):l})};function ye({categories:i=[]}){var _;const{t:r,i18n:d}=U(),[s,l]=u.useState("all"),[t,m]=u.useState([]),[g,f]=u.useState(!0),[h,y]=u.useState(1),[j,o]=u.useState(!0),c=[{key:"all",label:"All"},...i.map(n=>({...n,key:n.key||n.id,label:n.label||(d.language==="en"?n.name_en:n.name_id)}))],b=u.useCallback(async(n,w,q=!1)=>{f(!0);try{const N=await le.get("/api/products",{params:{category:n==="all"?void 0:n,page:w}}),a=N.data.data||N.data;m(p=>q?[...p,...a]:a),o(N.data.next_page_url!==null)}catch{m([]),o(!1)}f(!1)},[]);u.useEffect(()=>{y(1),b(s,1,!1)},[s,b]);const S=()=>{b(s,h+1,!0),y(n=>n+1)};return e.jsxs("section",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4",children:[e.jsx("h2",{className:"text-gray-900 font-semibold text-lg mb-3 sm:mb-0",children:r("home.allProducts")}),e.jsx("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600 font-semibold",children:c.map(n=>e.jsx("button",{className:`rounded-full px-3 py-1 transition ${s===n.key?"bg-[#D9B36A] text-[#0E1C2D] hover:bg-[#caa45f]":"bg-white border border-gray-300 hover:bg-gray-100"}`,onClick:()=>{l(n.key),m([]),o(!0)},disabled:g,children:n.label},n.key))})]}),e.jsxs("p",{className:"text-gray-500 text-xs mb-6",children:[r("global.showing"),": ",s==="all"?"All":(_=c.find(n=>n.key===s))==null?void 0:_.label]}),e.jsxs(ge,{dataLength:t.length,next:S,hasMore:j,scrollThreshold:.75,children:[!g&&t.length===0&&e.jsx(te,{}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 py-5 overflow-hidden",children:[t.map(n=>e.jsx(ee,{product:n,isFavorited:n.isFavorite,favoriteDisplayOnly:!0,showFavorite:!0},n.id)),g&&t.length>0&&Array.from({length:5}).map((n,w)=>e.jsx(J,{},`skeleton-next-${w}`)),g&&t.length===0&&Array.from({length:10}).map((n,w)=>e.jsx(J,{},w))]})]})]})}var $={},Z;function ve(){if(Z)return $;Z=1;function i(t){if(typeof window>"u")return;const m=document.createElement("style");return m.setAttribute("type","text/css"),m.innerHTML=t,document.head.appendChild(m),t}Object.defineProperty($,"__esModule",{value:!0});var r=ce();function d(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var s=d(r);i(`.rfm-marquee-container {
  overflow-x: hidden;
  display: flex;
  flex-direction: row;
  position: relative;
  width: var(--width);
  transform: var(--transform);
}
.rfm-marquee-container:hover div {
  animation-play-state: var(--pause-on-hover);
}
.rfm-marquee-container:active div {
  animation-play-state: var(--pause-on-click);
}

.rfm-overlay {
  position: absolute;
  width: 100%;
  height: 100%;
}
.rfm-overlay::before, .rfm-overlay::after {
  background: linear-gradient(to right, var(--gradient-color), rgba(255, 255, 255, 0));
  content: "";
  height: 100%;
  position: absolute;
  width: var(--gradient-width);
  z-index: 2;
  pointer-events: none;
  touch-action: none;
}
.rfm-overlay::after {
  right: 0;
  top: 0;
  transform: rotateZ(180deg);
}
.rfm-overlay::before {
  left: 0;
  top: 0;
}

.rfm-marquee {
  flex: 0 0 auto;
  min-width: var(--min-width);
  z-index: 1;
  display: flex;
  flex-direction: row;
  align-items: center;
  animation: scroll var(--duration) linear var(--delay) var(--iteration-count);
  animation-play-state: var(--play);
  animation-delay: var(--delay);
  animation-direction: var(--direction);
}
@keyframes scroll {
  0% {
    transform: translateX(0%);
  }
  100% {
    transform: translateX(-100%);
  }
}

.rfm-initial-child-container {
  flex: 0 0 auto;
  display: flex;
  min-width: auto;
  flex-direction: row;
  align-items: center;
}

.rfm-child {
  transform: var(--transform);
}`);const l=r.forwardRef(function({style:m={},className:g="",autoFill:f=!1,play:h=!0,pauseOnHover:y=!1,pauseOnClick:j=!1,direction:o="left",speed:c=50,delay:b=0,loop:S=0,gradient:_=!1,gradientColor:n="white",gradientWidth:w=200,onFinish:q,onCycleComplete:N,onMount:a,children:p},P){const[x,M]=r.useState(0),[R,re]=r.useState(0),[A,z]=r.useState(1),[B,se]=r.useState(!1),ne=r.useRef(null),k=P||ne,L=r.useRef(null),I=r.useCallback(()=>{if(L.current&&k.current){const v=k.current.getBoundingClientRect(),O=L.current.getBoundingClientRect();let E=v.width,C=O.width;(o==="up"||o==="down")&&(E=v.height,C=O.height),z(f&&E&&C&&C<E?Math.ceil(E/C):1),M(E),re(C)}},[f,k,o]);r.useEffect(()=>{if(B&&(I(),L.current&&k.current)){const v=new ResizeObserver(()=>I());return v.observe(k.current),v.observe(L.current),()=>{v&&v.disconnect()}}},[I,k,B]),r.useEffect(()=>{I()},[I,p]),r.useEffect(()=>{se(!0)},[]),r.useEffect(()=>{typeof a=="function"&&a()},[]);const W=r.useMemo(()=>f?R*A/c:R<x?x/c:R/c,[f,x,R,A,c]),ae=r.useMemo(()=>Object.assign(Object.assign({},m),{"--pause-on-hover":!h||y?"paused":"running","--pause-on-click":!h||y&&!j||j?"paused":"running","--width":o==="up"||o==="down"?"100vh":"100%","--transform":o==="up"?"rotate(-90deg)":o==="down"?"rotate(90deg)":"none"}),[m,h,y,j,o]),oe=r.useMemo(()=>({"--gradient-color":n,"--gradient-width":typeof w=="number"?`${w}px`:w}),[n,w]),H=r.useMemo(()=>({"--play":h?"running":"paused","--direction":o==="left"?"normal":"reverse","--duration":`${W}s`,"--delay":`${b}s`,"--iteration-count":S?`${S}`:"infinite","--min-width":f?"auto":"100%"}),[h,o,W,b,S,f]),D=r.useMemo(()=>({"--transform":o==="up"?"rotate(90deg)":o==="down"?"rotate(-90deg)":"none"}),[o]),V=r.useCallback(v=>[...Array(Number.isFinite(v)&&v>=0?v:0)].map((O,E)=>s.default.createElement(r.Fragment,{key:E},r.Children.map(p,C=>s.default.createElement("div",{style:D,className:"rfm-child"},C)))),[D,p]);return B?s.default.createElement("div",{ref:k,style:ae,className:"rfm-marquee-container "+g},_&&s.default.createElement("div",{style:oe,className:"rfm-overlay"}),s.default.createElement("div",{className:"rfm-marquee",style:H,onAnimationIteration:N,onAnimationEnd:q},s.default.createElement("div",{className:"rfm-initial-child-container",ref:L},r.Children.map(p,v=>s.default.createElement("div",{style:D,className:"rfm-child"},v))),V(A-1)),s.default.createElement("div",{className:"rfm-marquee",style:H},V(A))):null});return $.default=l,$}var we=ve();const je=de(we);function be(){const[i,r]=u.useState([]),[d,s]=u.useState(!0);return u.useEffect(()=>{fetch("/api/partners").then(l=>l.json()).then(l=>{let t=l.partners;if(t.length>0&&t.length<4){const m=Math.ceil(9/t.length);t=Array(m).fill(t).flat().slice(0,9)}r(t),s(!1)}).catch(()=>s(!1))},[]),d?e.jsx("div",{children:"Loading..."}):e.jsx(e.Fragment,{children:i.length>0&&e.jsx("section",{className:"bg-gray-50 py-8",children:e.jsx(je,{pauseOnHover:!0,speed:50,gradient:!0,children:i.map((l,t)=>e.jsx("img",{src:F(l.image),alt:l.name,className:"lg:h-10 h-5 mx-6"},t))})})})}function Ke(){var N;const{t:i}=U(),r=T().props.auth,d=((N=r==null?void 0:r.user)==null?void 0:N.isPreferenceStored)??null,[s,l]=u.useState([]),[t,m]=u.useState(!0),[g,f]=u.useState([]),[h,y]=u.useState(!0),[j,o]=u.useState([]),[c,b]=u.useState(!0),S=async(a,p)=>{const P=localStorage.getItem("preferences");if(!(a!=null&&a.user)||p||!P)return;const x=JSON.parse(P);try{await axios.post("/api/user/preference",{categories:x.categories,ingredients:x.ingredients,budget:x.budget}),console.log("Preferences synced to server.")}catch(M){console.error("Failed to sync preferences:",M)}},_=async()=>{try{y(!0);const p=await(await fetch("/api/categories")).json();f(p||[])}catch{f([])}finally{y(!1)}},n=async()=>{try{b(!0);const a=await axios.get("/api/our-selection");o(a.data||[])}catch(a){console.error("Error fetching our selection:",a),o([])}finally{b(!1)}},w=async a=>{var p,P;try{m(!0);const x=JSON.parse(localStorage.getItem("preferences"))||{};if(!(a!=null&&a.user)&&!((p=x.categories)!=null&&p.length)&&!((P=x.ingredients)!=null&&P.length))return;const M=a!=null&&a.user?{}:{categories:x.categories,ingredients:x.ingredients,budget:x.budget},R=await axios.get("/get-recommendations",{params:M});l(R.data||[])}catch(x){console.error("Error fetching recommendations:",x)}finally{m(!1)}},q=a=>{const p=localStorage.getItem("preferences");!(a!=null&&a.user)&&!p&&Q.visit("/")};return u.useEffect(()=>{(async()=>{q(r),await w(r),await S(r,d),await _(),await n()})()},[r==null?void 0:r.user,d]),e.jsxs(me,{className:"px-4 sm:px-6 md:px-10 lg:px-16 pb-10",children:[e.jsx(he,{categories:g,isLoading:h}),e.jsx(X,{}),j.length>1&&e.jsx(K,{products:j,title:i("home.ourSelection"),imageUrl:"",isLoading:c,isRecommendationType:!1}),e.jsx(K,{products:s.recommendations,title:i("home.recommendationForYou"),imageUrl:"",isLoading:t,isRecommendationType:!0}),e.jsx(ye,{categories:g}),e.jsx(X,{type:"event_bottom"}),e.jsx(be,{})]})}export{Ke as default};
