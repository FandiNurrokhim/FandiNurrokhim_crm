import{r as c,v as B,j as a,m as D}from"./app-DdujxetC.js";import{S as h}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{S as x}from"./react-select.esm-DoIX5jeO.js";import{r as S}from"./index-Rb7ez85R.js";import{M as k}from"./Modal-C4vY61V8.js";import{I as d}from"./InputLabel-BzWnVHML.js";import{T as E}from"./TextInput-BmMh6PqU.js";import{I as m}from"./InputError-Cg3yzoP4.js";import{A}from"./ActiveToogle-B-WZcVjZ.js";import{U as f}from"./UploadInputWithView-BeMryQyC.js";import{a as U}from"./getErrorMessage-BiY5rOY1.js";import{u as W}from"./useTranslation-8BayAZb4.js";import"./toConsumableArray-Bj8NDksB.js";import"./index-BnYHGNjJ.js";import"./floating-ui.dom-AzuEyJcm.js";import"./PrimaryButton-DWDteuQq.js";import"./transition-BZAsKsJL.js";import"./dialog-Cmhm8y39.js";import"./XMarkIcon-Duw6_-fQ.js";const ne=({isOpen:p,onClose:u,product:r,setRefetch:N})=>{if(!r)return null;const{t:i,i18n:_}=W(),[q,$]=c.useState([]),[w,M]=c.useState([]),[T,I]=c.useState([]),{data:t,setData:s,processing:y,errors:n,reset:v}=B({name:r.name||"",price:r.price||0,portion_info:r.portion_info||"",description_id:r.description_id||"",description_en:r.description_en||"",stand_id:r.stand_id||"",categories:r.categories?r.categories.map(e=>e.id):[],ingredients:r.ingredients?r.ingredients.map(e=>e.id):[],is_active:r.is_active||0,image:r.image||"",image_2:r.image_2||"",image_3:r.image_3||"",message:""});c.useEffect(()=>{p&&fetch("/admin/product/select-data").then(e=>e.json()).then(e=>{$(e.data.stands||[]),M(e.data.categories||[]),I(e.data.ingredients||[])}).catch(()=>{h.fire("Error!","Gagal mengambil data stand","error")})},[p]);const g=e=>{s(e.target.name,e.target.value)},F=e=>{e.preventDefault();const o={...t,_method:"put"};["image","image_2","image_3"].forEach(l=>{o[l]&&typeof o[l]!="object"&&delete o[l]}),D.post(`/admin/product/${r.id}`,{...o,_method:"put"},{onSuccess:()=>{v(),u(),N(l=>!l),h.fire({icon:"success",title:i("global.swalSuccess"),text:i("product.pageTitle")+" "+i("global.updatedMessage")})},onError:l=>{const z=U(l.message,_.language);console.error("Error updating product:",l),h.fire("Error!",z,"error")}})},j=q.map(e=>({value:e.id,label:e.name})),b=w.map(e=>({value:e.id,label:_.language==="id"?e.name_id:e.name_en})),C=T.map(e=>({value:e.id,label:_.language==="id"?e.name_id:e.name_en}));return a.jsxs(k,{show:p,onClose:u,title:i("product.pageTitle"),type:"edit",maxWidth:"2xl",onCancel:()=>{u(),v()},processing:y,onSubmit:F,children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"w-1/2",children:[a.jsx(d,{htmlFor:"name",value:`${i("global.name")}`,required:!0}),a.jsx(E,{id:"name",name:"name",value:t.name,onChange:g,className:"mt-1 block w-full",required:!0,autoComplete:"off",placeholder:`${i("global.name")} ${i("product.pageTitle")}`}),a.jsx(m,{message:n.name,className:"mt-2"})]}),a.jsxs("div",{className:"w-1/2",children:[a.jsx(d,{htmlFor:"price",value:`${i("global.price")}`,required:!0}),a.jsx(E,{id:"price",name:"price",value:t.price,type:"number",onChange:g,className:"mt-1 block w-full",required:!0,autoComplete:"off",placeholder:`${i("global.price")} ${i("product.pageTitle")}`}),a.jsx(m,{message:n.price,className:"mt-2"})]})]}),a.jsx(f,{id:"image",name:"image",label:i("global.image"),accept:".jpg,.jpeg,.png",maxSizeMB:.5,onChange:e=>s("image",e.target.files[0]),value:t.image,error:n.image,required:!0}),a.jsx(f,{id:"image_2",name:"image_2",label:i("global.image")+" 2",accept:".jpg,.jpeg,.png",maxSizeMB:.5,onChange:e=>s("image_2",e.target.files[0]),value:t.image_2,error:n.image_2,required:!0}),a.jsx(f,{id:"image_3",name:"image_3",label:i("global.image")+" 3",accept:".jpg,.jpeg,.png",maxSizeMB:.5,onChange:e=>s("image_3",e.target.files[0]),value:t.image_3,error:n.image_3,required:!0}),a.jsxs("div",{children:[a.jsx(d,{htmlFor:"stand_id",value:"Stand",required:!0}),a.jsx(x,{options:j,id:"stand_id",name:"stand_id",value:j.find(e=>e.value===t.stand_id)||null,onChange:e=>{s("stand_id",e?e.value:"")},placeholder:i("product.selectStand"),isClearable:!0})]}),a.jsxs("div",{children:[a.jsx(d,{htmlFor:"category_id",value:`${i("category.pageTitle")} (EN)`,required:!0}),a.jsx(x,{options:b,id:"category_id",name:"category_id",isMulti:!0,value:b.filter(e=>t.categories.includes(e.value)),onChange:e=>{s("categories",e?e.map(o=>o.value):[])},placeholder:i("product.selectCategory"),isClearable:!0})]}),a.jsxs("div",{children:[a.jsx(d,{htmlFor:"ingredient_id",value:`${i("ingredient.pageTitle")} (EN)`,required:!0}),a.jsx(x,{options:C,id:"ingredient_id",name:"ingredient_id",isMulti:!0,value:C.filter(e=>t.ingredients.includes(e.value)),onChange:e=>{s("ingredients",e?e.map(o=>o.value):[])},placeholder:i("product.selectIngredient"),isClearable:!0})]}),a.jsxs("div",{children:[a.jsx(d,{htmlFor:"description_id",value:`${i("global.description")} (ID)`,required:!0}),a.jsx(S.Textarea,{name:"description_id",id:"description_id",value:t.description_id,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",onChange:g,placeholder:i("global.description")+" "+i("global.inId")}),a.jsx(m,{message:n.description_id,className:"mt-2"})]}),a.jsxs("div",{children:[a.jsx(d,{htmlFor:"description_en",value:`${i("global.description")} (EN)`,required:!0}),a.jsx(S.Textarea,{name:"description_en",id:"description_en",value:t.description_en,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",onChange:g,placeholder:i("global.description")+" "+i("global.inEn")}),a.jsx(m,{message:n.description_en,className:"mt-2"})]}),a.jsx(A,{value:t.is_active,onChange:e=>s("is_active",e),required:!0}),a.jsx(m,{message:n.is_active,className:"mt-2"})]})};export{ne as default};
