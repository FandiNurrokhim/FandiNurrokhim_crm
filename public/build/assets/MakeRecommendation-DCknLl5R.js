import{r as a,j as e,a as w}from"./app-DdujxetC.js";import{S as b}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{I as _}from"./index.es-BVb1l-Mq.js";import{R as B}from"./Rating-XxgJT9dk.js";import{L as T}from"./LimitedText-Dj5mDYrI.js";import{L as N}from"./Logo-Dq8nsJV3.js";import{g as $}from"./imageHelper-19DfnHcd.js";import{u as I}from"./useTranslation-8BayAZb4.js";function P({title:s,titleId:r,...c},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},c),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const V=a.forwardRef(P);function F({title:s,titleId:r,...c},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},c),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"}))}const H=a.forwardRef(F),Z=({children:s,onClick:r,className:c,...n})=>e.jsx("button",{onClick:r,className:`px-4 py-2 rounded-full font-medium transition ${c}`,...n,children:s}),y=10,O=()=>e.jsxs("div",{className:"border-2 border-gray-200 p-4 rounded-lg h-40 animate-pulse bg-gray-100",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-300 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-1"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),W=({recommendations:s})=>{const{t:r,i18n:c}=I(),[n,p]=a.useState("grid"),[m,k]=a.useState([]),[l,u]=a.useState([]),[g,S]=a.useState(1),[j,A]=a.useState(1),[M,h]=a.useState(!1),[f,E]=a.useState(""),[x,C]=a.useState(""),D=t=>{if(l.includes(t)){const o=l.filter(i=>i!==t);u(o)}else{if(l.length>=y){b.fire("Info",`Maksimal ${y} rekomendasi saja!`,"info");return}const o=[...l,t];u(o)}};a.useEffect(()=>{if(s&&s.length>0){const t=s.map(o=>o.food_id??o.id);u(t)}},[s]);const v=(t=1,o="")=>{h(!0),w.get("/admin/product/data",{params:{page:t,search:o,filter:{is_active:!0}}}).then(i=>{console.log("Page:",t,"Fetched:",i.data.data.length,"Total dishes before:",m.length),k(d=>t===1?i.data.data:[...d,...i.data.data]),A(i.data.last_page),S(t),h(!1)}).catch(()=>h(!1))};a.useEffect(()=>{v(1,f)},[f]),a.useEffect(()=>{const t=setTimeout(()=>{E(x)},500);return()=>clearTimeout(t)},[x]);const R=()=>{g<j&&v(g+1,f)},L=()=>{w.post("/admin/recommendation/save",{food_ids:l}).then(()=>{b.fire({icon:"success",title:r("global.swalSuccess"),text:r("product.recommendationCreated")})}).catch(()=>{b.fire("Gagal","Terjadi kesalahan saat menyimpan rekomendasi.","error")})};return e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-4 sticky top-20 z-10 bg-white",children:[e.jsxs("div",{className:"flex md:flex-row flex-col items-center justify-between pb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:r("global.createManualRecommendation")}),e.jsxs("div",{className:"flex md:flex-row flex-col md:items-center items-start gap-2",children:[e.jsxs(Z,{className:"border-2 text-white bg-[#D9B36A] border-[#D9B36A] rounded-lg flex items-center justify-center cursor-pointer hover:bg-[#b89a54] hover:border-[#b89a54] transition duration-200 ease-in-out",onClick:L,disabled:l.length===0,children:[r("global.save")," ",r("global.recommendation")," (",l.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:`p-2 rounded-md ${n==="grid"?"bg-[#D9B36A] text-white":"bg-gray-100"}`,onClick:()=>p("grid"),children:e.jsx(H,{className:"h-5 w-5"})}),e.jsx("button",{className:`p-2 rounded-md ${n==="list"?"bg-[#D9B36A] text-white":"bg-gray-100"}`,onClick:()=>p("list"),children:e.jsx(V,{className:"h-5 w-5"})})]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",placeholder:r("navbar.searchPlaceholder"),value:x,onChange:t=>C(t.target.value)})})]}),e.jsx(_,{dataLength:m.length,next:R,hasMore:g<j,scrollThreshold:.95,scrollableTarget:"scrollableDiv",className:"overflow-y-auto rounded-2xl",children:e.jsxs("div",{className:n==="grid"?"grid lg:grid-cols-3 md:grid-cols-3 grid-cols-1 gap-4":"space-y-4",children:[m.map(t=>{const o=l.includes(t.id),i=c.language==="en"?t.description_en:t.description_id;return e.jsxs("div",{className:`cursor-pointer border-2 p-4 flex rounded-lg shadow-sm hover:shadow-md transition ${n==="list"?"flex-row gap-4":"flex-col gap-4"} ${o?"border-[#D9B36A] ring-2 ring-[none]":"border-gray-200"}`,onClick:()=>D(t.id),children:[e.jsx("img",{src:t.image?$(t.image):N,alt:t.name,className:"w-16 h-16 rounded-full object-cover",onError:d=>{d.target.onerror=null,d.target.src=N}}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:t.category}),e.jsx("div",{className:"font-medium",children:t.name}),e.jsxs("div",{className:"text-black font-semibold",children:["Rp. ",t.price]}),e.jsx(B,{rating:t.average_rating,userReviewCount:t.rating_count}),e.jsx(T,{text:i,limit:5})]})]},t.id)}),M&&Array.from({length:10}).map((t,o)=>e.jsx(O,{},`skeleton-${o}`))]})})]})},Y=({manualRecommendations:s})=>e.jsx(e.Fragment,{children:e.jsx(W,{recommendations:s})});export{Y as default};
